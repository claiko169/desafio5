<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Desafío 5 - Puzzle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: linear-gradient(135deg, #ff9a8b, #ff6a88, #ff4f92);
      font-family: 'Courier New', Courier, monospace;
      color: white;
      text-align: center;
      padding: 20px;
      transition: background 1s, color 1s;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 20px;
    }

    #puzzle {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-template-rows: repeat(5, 60px);
      gap: 5px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .pieza {
      width: 60px;
      height: 60px;
      border-radius: 5px;
      background-size: cover;
      cursor: pointer;
    }

    #mensaje {
      display: none;
      margin-top: 30px;
    }

    .pregunta {
      margin-top: 20px;
    }

    .pregunta img {
      width: 200px;
      border-radius: 20px;
    }

    .botones {
      margin-top: 20px;
      position: relative;
      z-index: 10;
    }

    button {
      padding: 12px 25px;
      font-size: 1em;
      margin: 10px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
    }

    .si {
      background-color: #a3ffba;
      color: #003300;
    }

    .no {
      background-color: #ff6a6a;
      color: white;
    }

    #musicaBtn {
      margin-top: 20px;
      background: white;
      color: #ff6a88;
    }

    .glitch {
      animation: glitch 0.3s infinite;
    }

    @keyframes glitch {
      0% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(2px, -2px); }
      60% { transform: translate(-2px, -2px); }
      80% { transform: translate(2px, 2px); }
      100% { transform: translate(0); }
    }
  </style>
</head>
<body>

  <h1 id="titulo">Completa el puzzle con nuestras fotos ❤️</h1>
  <p>Une correctamente todas las piezas para desbloquear la pregunta especial...</p>

  <div id="puzzle"></div>

  <div id="mensaje">
    <div class="pregunta">
      <img src="novia.jpg" alt="pregunta">
      <h2>¡Quieres ser mi novia?</h2>
    </div>
    <div class="botones" id="botones">
      <button class="si" onclick="aceptar()">Sí</button>
      <button class="no" id="btnNo" onclick="negar()">No</button>
    </div>
  </div>

  <p id="amenaza" style="font-size: 1.5em; margin-top: 30px;"></p>

  <button id="musicaBtn" onclick="toggleMusica()">Pausar/Reanudar Música</button>

  <audio id="musica" autoplay loop>
    <source src="si.mp3" type="audio/mpeg">
  </audio>

  <audio id="efecto" src="glitch.mp3"></audio>

  <script>
    const piezas = [];
    const imagenes = ['us.jpg', 'us2.jpg', 'us3.jpg', 'us4.jpg', 'us5.jpg'];

    for (let i = 0; i < 25; i++) {
      piezas.push({ img: imagenes[Math.floor(Math.random() * imagenes.length)], index: i });
    }

    piezas.sort(() => Math.random() - 0.5);

    const puzzleDiv = document.getElementById("puzzle");

    piezas.forEach((pieza, i) => {
      const div = document.createElement("div");
      div.classList.add("pieza");
      div.style.backgroundImage = `url('${pieza.img}')`;
      div.setAttribute("draggable", "true");
      div.dataset.index = i;
      puzzleDiv.appendChild(div);
    });

    let dragSrc = null;

    document.querySelectorAll(".pieza").forEach(pieza => {
      pieza.addEventListener("dragstart", function (e) {
        dragSrc = this;
      });
      pieza.addEventListener("dragover", function (e) {
        e.preventDefault();
      });
      pieza.addEventListener("drop", function (e) {
        e.preventDefault();
        if (dragSrc !== this) {
          const tempBg = dragSrc.style.backgroundImage;
          dragSrc.style.backgroundImage = this.style.backgroundImage;
          this.style.backgroundImage = tempBg;
          checkPuzzle();
        }
      });
    });

    function checkPuzzle() {
      const piezasActuales = document.querySelectorAll(".pieza");
      const primera = piezasActuales[0].style.backgroundImage;
      const completo = [...piezasActuales].every(p => p.style.backgroundImage === primera);
      if (completo) {
        document.getElementById("mensaje").style.display = "block";
      }
    }

    function aceptar() {
      window.location.href = "si.html";
    }

    let contadorNo = 0;
    const amenazas = [
      "No deberías haber hecho eso.",
      "Te estoy observando.",
      "Cada vez estás más cerca del final...",
      "¿Por qué sigues pulsando?",
      "No hay escapatoria.",
      "Esto no es un juego para ti.",
      "En serio, para.",
      "Me estás rompiendo el corazón.",
      "Por favor... Ally, piénsalo.",
      "....",
      "¿No te soy suficiente?",
      "agh...",
      "No sigas",
      "¿De verdad quieres decir que no?",
      "Está bien... ya dejo de insistir",
      "¡No tienes escapatoria!"
    ];

    function negar() {
      contadorNo++;

      document.getElementById("efecto").play();
      document.body.style.background = "#000";
      document.body.style.color = "red";
      document.getElementById("titulo").style.color = "red";

      const amenaza = amenazas[(contadorNo - 1) % amenazas.length];
      document.getElementById("amenaza").textContent = amenaza;

      if (contadorNo === 16) {
        document.getElementById("btnNo").remove();
        const musica = document.getElementById("musica");
        musica.src = "terror.mp3";
        musica.play();

        const botonesDiv = document.getElementById("botones");
        for (let i = 0; i < 20; i++) {
          const nuevoBtn = document.createElement("button");
          nuevoBtn.className = "si glitch";
          nuevoBtn.textContent = "Sí";
          nuevoBtn.onclick = aceptar;
          nuevoBtn.style.position = "absolute";
          nuevoBtn.style.left = Math.random() * window.innerWidth + "px";
          nuevoBtn.style.top = Math.random() * window.innerHeight + "px";
          botonesDiv.appendChild(nuevoBtn);
        }
      }
    }

    function toggleMusica() {
      const musica = document.getElementById("musica");
      if (musica.paused) {
        musica.play();
      } else {
        musica.pause();
      }
    }
  </script>

</body>
</html>
   
